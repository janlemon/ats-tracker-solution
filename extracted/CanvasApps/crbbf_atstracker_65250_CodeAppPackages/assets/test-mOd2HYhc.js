import{r,j as t,C as j,c as f,d as C,e as $,f as N,I as E,B as l,n as h}from"./index-BElxQeur.js";import{L as I}from"./label-2xgWSV0F.js";import{E as A,g as O,a as P}from"./AttachmentService-C8YzT5nu.js";function z(){const[m,n]=r.useState(!1),[g,s]=r.useState(""),[c,b]=r.useState([]),[x,w]=r.useState("Test Request"),[i,y]=r.useState(""),[p,d]=r.useState(""),[u,R]=r.useState([]),[v,S]=r.useState(!1),o=async()=>{n(!0),s("Loading...");try{const e=await h.getAll();e.data?(b(e.data),s(`SUCCESS: Loaded ${e.data.length} requests`)):s(`ERROR: ${e.error?.message||"Unknown error"}`)}catch(e){s(`EXCEPTION: ${e instanceof Error?e.message:String(e)}`)}n(!1)},T=async()=>{n(!0),s("Creating...");try{const e=await h.create({Title:x,ATSType:{Value:"New"},SystemStatus:{Value:"Draft"}});e.data?(s(`SUCCESS: Created request with ID ${e.data.ID}`),o()):s(`ERROR: ${e.error?.message||"Unknown error"}`)}catch(e){s(`EXCEPTION: ${e instanceof Error?e.message:String(e)}`)}n(!1)},k=async e=>{n(!0),s("Updating...");try{const a=await h.update(e,{Title:`Updated at ${new Date().toISOString()}`});a.data?(s(`SUCCESS: Updated request ${e}`),o()):s(`ERROR: ${a.error?.message||"Unknown error"}`)}catch(a){s(`EXCEPTION: ${a instanceof Error?a.message:String(a)}`)}n(!1)},D=async e=>{n(!0),s("Deleting...");try{await h.delete(e),s(`SUCCESS: Deleted request ${e}`),o()}catch(a){s(`EXCEPTION: ${a instanceof Error?a.message:String(a)}`)}n(!1)},U=async()=>{if(!i){d("ERROR: Please enter Item ID");return}S(!0),d("Loading attachments...");try{const e=await P(parseInt(i));R(e),d(`SUCCESS: Found ${e.length} attachment(s)
${JSON.stringify(e,null,2)}`)}catch(e){d(`EXCEPTION: ${e instanceof Error?e.message:String(e)}`)}S(!1)};return t.jsxs("div",{className:"p-8 max-w-4xl mx-auto space-y-6",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"SharePoint CRUD Test"}),t.jsxs(j,{className:"border-2 border-blue-500",children:[t.jsxs(f,{className:"bg-blue-50 dark:bg-blue-950",children:[t.jsx(C,{className:"text-blue-700 dark:text-blue-300",children:"ðŸ“Ž Attachment Test"}),t.jsx($,{children:"Test reading attachments and link to SharePoint for uploading"})]}),t.jsxs(N,{className:"space-y-4 pt-4",children:[t.jsxs("div",{className:"flex gap-4 items-end",children:[t.jsxs("div",{className:"w-32",children:[t.jsx(I,{htmlFor:"itemId",children:"Item ID"}),t.jsx(E,{id:"itemId",value:i,onChange:e=>y(e.target.value),placeholder:"e.g. 123"})]}),t.jsx(l,{onClick:U,disabled:v||!i,variant:"outline",children:"Get Attachments"}),i&&t.jsxs(l,{variant:"default",onClick:()=>window.open(O(parseInt(i)),"_blank"),children:[t.jsx(A,{className:"mr-2 h-4 w-4"}),"Open in SharePoint"]})]}),u.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs(I,{children:["Attachments (",u.length,")"]}),u.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[t.jsx("span",{children:e.name}),e.url&&t.jsx(l,{size:"sm",variant:"ghost",onClick:()=>window.open(e.url,"_blank"),children:"Open"})]},e.id))]}),p&&t.jsx("pre",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded text-xs overflow-auto max-h-48",children:p})]})]}),t.jsxs(j,{children:[t.jsx(f,{children:t.jsx(C,{children:"SharePoint CRUD Operations"})}),t.jsxs(N,{className:"space-y-4",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(l,{onClick:o,disabled:m,children:m?"Loading...":"Read All"}),t.jsx(E,{value:x,onChange:e=>w(e.target.value),placeholder:"New title",className:"w-48"}),t.jsx(l,{onClick:T,disabled:m,variant:"secondary",children:"Create"})]}),g&&t.jsx("pre",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded text-sm",children:g}),c.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("h3",{className:"font-semibold",children:["Requests (",c.length,")"]}),c.slice(0,10).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[t.jsxs("span",{children:[t.jsxs("strong",{children:["#",e.ID]})," - ",e.Title]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(l,{size:"sm",variant:"outline",onClick:()=>k(String(e.ID)),children:"Update"}),t.jsx(l,{size:"sm",variant:"destructive",onClick:()=>D(String(e.ID)),children:"Delete"})]})]},e.ID)),c.length>10&&t.jsxs("p",{className:"text-sm text-muted-foreground",children:["... and ",c.length-10," more"]})]})]})]})]})}export{z as default};
