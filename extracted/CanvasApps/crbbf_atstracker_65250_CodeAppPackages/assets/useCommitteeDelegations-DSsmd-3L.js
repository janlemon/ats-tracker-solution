import{v as d,aC as m}from"./index-BElxQeur.js";function i(r){if(!r)return null;const n=(r.Claims||"").match(/\|([^|]+)$/);return n?n[1].toLowerCase():r.Email?.toLowerCase()||null}function C(){const{data:r,isLoading:g,error:n}=d({queryKey:["committee-delegations"],queryFn:async()=>{const e=await m.getAll();return console.log("[useCommitteeDelegations] Raw data:",e.data),e.data||[]},staleTime:3e5,retry:1}),c=r||[],u=e=>{if(!e.Active)return!1;const a=new Date;if(e.ValidFrom){const t=new Date(e.ValidFrom);if(a<t)return!1}if(e.ValidTo){const t=new Date(e.ValidTo);if(a>t)return!1}return!0};return{delegations:c,isLoading:g,error:n,getDelegatedVotesFor:e=>{if(!e)return[];const a=e.toLowerCase(),t=[];for(const o of c)if(i(o.Delegate)===a&&u(o)){const l=i(o.Delegator);l&&t.push({delegatorName:o.Delegator?.DisplayName||"Unknown",delegatorEmail:l,delegateName:o.Delegate?.DisplayName||e})}return t},canVoteFor:(e,a)=>{if(!e||!a)return!1;const t=e.toLowerCase(),o=a.toLowerCase();if(t===o)return!0;for(const s of c){const l=i(s.Delegate),f=i(s.Delegator);if(l===t&&f===o&&u(s))return!0}return!1},isDelegationActive:u}}export{C as u};
